@model ResumeProject.Entities.About
@{
    ViewData["Title"] = "Yeni Profil Ekle";
    Layout = "~/Views/AdminLayout/Index.cshtml";
}

<script src="https://cdn.tailwindcss.com"></script>

<div class="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6">
    <div class="max-w-3xl mx-auto">

        <!-- Header -->
        <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 mb-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-slate-800">Yeni Profil Ekle</h1>
                    <p class="text-slate-500 mt-1">Hakkımda bilgilerinizi ekleyin</p>
                </div>
                <a href="@Url.Action("AboutList")" class="flex items-center gap-2 text-slate-600 hover:text-slate-800 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="19" y1="12" x2="5" y2="12"></line>
                        <polyline points="12 19 5 12 12 5"></polyline>
                    </svg>
                    Geri
                </a>
            </div>
        </div>

        <!-- Form -->
        <form asp-action="CreateAbout" method="post" enctype="multipart/form-data" class="space-y-6">

            <!-- Profil Resmi -->
            <!-- Profil Resmi URL -->
            <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6">
                <label asp-for="ImageUrl" class="block text-sm font-medium text-slate-700 mb-2">Profil Resim URL</label>
                <input asp-for="ImageUrl" placeholder="https://example.com/profil.jpg"
                       class="w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-slate-800" />
                <span asp-validation-for="ImageUrl" class="text-red-500 text-sm"></span>
            </div>


            <!-- Ad Soyad -->
            <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6">
                <label asp-for="NameSurname" class="block text-sm font-medium text-slate-700 mb-2">Ad Soyad</label>
                <input asp-for="NameSurname" class="w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-slate-800" placeholder="Adınız Soyadınız">
                <span asp-validation-for="NameSurname" class="text-red-500 text-sm"></span>
            </div>

            <!-- Açıklama -->
            <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6">
                <label asp-for="Description" class="block text-sm font-medium text-slate-700 mb-2">Hakkımda</label>
                <textarea asp-for="Description" rows="8" class="w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none resize-none text-slate-800" placeholder="Kendiniz hakkında yazın..."></textarea>
                <span asp-validation-for="Description" class="text-red-500 text-sm"></span>
            </div>
            <!-- Skills -->

            <!-- Yetenekler (Skills) Bölümü - CreateAbout.cshtml içine eklenecek -->
            <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6">
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h2 class="text-lg font-semibold text-slate-800">Yetenekler</h2>
                        <p class="text-sm text-slate-500 mt-1">Becerilerinizi ve yüzde oranlarını ekleyin</p>
                    </div>
                    <button type="button" onclick="addSkill()" class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors text-sm font-medium">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Yetenek Ekle
                    </button>
                </div>

                <div id="skillsContainer" class="space-y-4">
                    <!-- Skills buraya dinamik olarak eklenecek -->
                </div>

                <!-- Template için gizli alan (optional) -->
                <div id="skillTemplate" class="hidden">
                    <div class="skill-item bg-slate-50 rounded-xl p-4 border border-slate-200">
                        <div class="grid grid-cols-1 md:grid-cols-12 gap-4">
                            <!-- Skill Title -->
                            <div class="md:col-span-5">
                                <label class="block text-xs font-medium text-slate-600 mb-1">Yetenek Adı</label>
                                <input type="text" name="Skills[0].Title" placeholder="Örn: Development"
                                       class="w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-slate-800 text-sm" />
                            </div>

                            <!-- Skill Percent -->
                            <div class="md:col-span-3">
                                <label class="block text-xs font-medium text-slate-600 mb-1">Yüzde (%)</label>
                                <input type="number" name="Skills[0].Percent" min="0" max="100" value="50"
                                       class="skill-percent w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-slate-800 text-sm"
                                       onchange="updateProgressBar(this)" />
                            </div>

                            <!-- Progress Bar Preview -->
                            <div class="md:col-span-3 flex items-end">
                                <div class="w-full">
                                    <label class="block text-xs font-medium text-slate-600 mb-1">Önizleme</label>
                                    <div class="w-full bg-slate-200 rounded-full h-2.5 overflow-hidden">
                                        <div class="skill-progress bg-gradient-to-r from-blue-600 to-blue-500 h-full transition-all duration-300" style="width: 50%"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Delete Button -->
                            <div class="md:col-span-1 flex items-end justify-end">
                                <button type="button" onclick="removeSkill(this)" class="p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="3 6 5 6 21 6"></polyline>
                                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                        <line x1="10" y1="11" x2="10" y2="17"></line>
                                        <line x1="14" y1="11" x2="14" y2="17"></line>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                let skillCounter = 0;

                // Sayfa yüklendiğinde varsayılan skill ekle
                document.addEventListener('DOMContentLoaded', function() {
                    // Varsayılan olarak 1 skill alanı ekle
                    addSkill();
                });

                // Yeni skill ekle
                function addSkill() {
                    const container = document.getElementById('skillsContainer');
                    const skillDiv = document.createElement('div');
                    skillDiv.className = 'skill-item bg-slate-50 rounded-xl p-4 border border-slate-200 transform transition-all duration-300';
                    skillDiv.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-12 gap-4">
                            <!-- Skill Title -->
                            <div class="md:col-span-5">
                                <label class="block text-xs font-medium text-slate-600 mb-1">Yetenek Adı</label>
                                <input type="text" name="Skills[${skillCounter}].Title" placeholder="Örn: Development, UI/UX Design"
                                       class="w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-slate-800 text-sm"
                                       required />
                            </div>

                            <!-- Skill Percent -->
                            <div class="md:col-span-3">
                                <label class="block text-xs font-medium text-slate-600 mb-1">Yüzde (%)</label>
                                <input type="number" name="Skills[${skillCounter}].Percent" min="0" max="100" value="50"
                                       class="skill-percent w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-slate-800 text-sm"
                                       onchange="updateProgressBar(this)"
                                       required />
                            </div>

                            <!-- Progress Bar Preview -->
                            <div class="md:col-span-3 flex items-end">
                                <div class="w-full">
                                    <label class="block text-xs font-medium text-slate-600 mb-1">Önizleme</label>
                                    <div class="w-full bg-slate-200 rounded-full h-2.5 overflow-hidden">
                                        <div class="skill-progress bg-gradient-to-r from-blue-600 to-blue-500 h-full transition-all duration-300" style="width: 50%"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Delete Button -->
                            <div class="md:col-span-1 flex items-end justify-end">
                                <button type="button" onclick="removeSkill(this)" class="p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors group">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="group-hover:scale-110 transition-transform">
                                        <polyline points="3 6 5 6 21 6"></polyline>
                                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                        <line x1="10" y1="11" x2="10" y2="17"></line>
                                        <line x1="14" y1="11" x2="14" y2="17"></line>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    `;

                    container.appendChild(skillDiv);

                    // Animasyon için
                    setTimeout(() => {
                        skillDiv.style.opacity = '0';
                        skillDiv.style.transform = 'translateY(-10px)';
                        setTimeout(() => {
                            skillDiv.style.opacity = '1';
                            skillDiv.style.transform = 'translateY(0)';
                        }, 10);
                    }, 0);

                    skillCounter++;
                }

                // Skill sil
                function removeSkill(button) {
                    const skillItem = button.closest('.skill-item');
                    const container = document.getElementById('skillsContainer');

                    // En az 1 skill kalmalı kontrolü (isterseniz kaldırabilirsiniz)
                    if (container.children.length <= 1) {
                        alert('En az bir yetenek eklemelisiniz!');
                        return;
                    }

                    // Animasyonlu silme
                    skillItem.style.opacity = '0';
                    skillItem.style.transform = 'translateX(20px)';
                    setTimeout(() => {
                        skillItem.remove();
                        // Index'leri yeniden düzenle
                        reindexSkills();
                    }, 300);
                }

                // Progress bar güncelle
                function updateProgressBar(input) {
                    const percent = parseInt(input.value) || 0;
                    const progressBar = input.closest('.grid').querySelector('.skill-progress');
                    progressBar.style.width = percent + '%';

                    // Renk değiştir (isteğe bağlı)
                    if (percent < 30) {
                        progressBar.className = 'skill-progress bg-gradient-to-r from-red-600 to-red-500 h-full transition-all duration-300';
                    } else if (percent < 70) {
                        progressBar.className = 'skill-progress bg-gradient-to-r from-yellow-600 to-yellow-500 h-full transition-all duration-300';
                    } else {
                        progressBar.className = 'skill-progress bg-gradient-to-r from-green-600 to-green-500 h-full transition-all duration-300';
                    }
                }

                // Skill indexlerini yeniden düzenle (silme sonrası)
                function reindexSkills() {
                    const container = document.getElementById('skillsContainer');
                    const skills = container.querySelectorAll('.skill-item');

                    skills.forEach((skill, index) => {
                        const titleInput = skill.querySelector('input[name*=".Title"]');
                        const percentInput = skill.querySelector('input[name*=".Percent"]');

                        if (titleInput) titleInput.name = `Skills[${index}].Title`;
                        if (percentInput) percentInput.name = `Skills[${index}].Percent`;
                    });
                }
            </script>

            <style>
                .skill-item {
                    transition: all 0.3s ease;
                }
            </style>

            <!-- Butonlar -->
            <div class="flex gap-3">
                <button type="submit" class="flex-1 flex items-center justify-center gap-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4 rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all shadow-lg shadow-blue-500/30 font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                        <polyline points="7 3 7 8 15 8"></polyline>
                    </svg>
                    Kaydet
                </button>
                <a href="@Url.Action("AboutList")" class="flex items-center justify-center gap-2 bg-slate-100 text-slate-700 px-6 py-4 rounded-xl hover:bg-slate-200 transition-colors font-medium">
                    İptal
                </a>
            </div>
        </form>

    </div>
</div>

<script>
    function previewImage(input) {
        const preview = document.getElementById('profilePreview');
        const placeholder = document.getElementById('placeholderIcon');

        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
                preview.classList.remove('hidden');
                placeholder.classList.add('hidden');
            }
            reader.readAsDataURL(input.files[0]);
        }
    }
</script>


